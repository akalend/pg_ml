SELECT ml_predict_table('astra3.cbm', 'astra');
NOTICE:  table "astra_predict" does not exist, skipping
   ml_predict_table   
----------------------
 public.astra_predict
(1 row)

SELECT * FROM astra_predict LIMIT 3;
 row |      alpha       |      delta       |    u     |    g     |    r     |    i     |    z     | run_id | cam_col | field_id |      spec_obj_id       |   redshift   | plate |  mjd  | fiber_id | predict  | class  
-----+------------------+------------------+----------+----------+----------+----------+----------+--------+---------+----------+------------------------+--------------+-------+-------+----------+----------+--------
   1 | 16.9568897845004 | 3.64613008870454 | 23.33542 | 21.95143 | 20.48149 |   19.603 | 19.13094 |   7712 |       6 |      442 |  4.855016555329904e+18 |    0.5062369 |  4312 | 55511 |      495 |  0.98686 | GALAXY
   2 | 240.063240247767 | 6.13413059813973 | 17.86033 | 16.79228 | 16.43001 | 16.30923 | 16.25873 |   3894 |       1 |      243 | 2.4489280322708705e+18 | 0.0003448142 |  2175 | 54612 |      348 | 0.990419 | STAR
   3 |  30.887222067625 | 1.18870964120799 | 18.18911 | 16.89469 | 16.42161 | 16.24627 | 16.18549 |   7717 |       1 |      536 |  8.255357438959835e+18 | 4.085216e-06 |  7332 | 56683 |      943 | 0.997588 | STAR
(3 rows)

SELECT * FROM ml_predict('astra3.cbm', 'astra') LIMIT 3;
 index |      predict       | class  
-------+--------------------+--------
 0     | 0.9868595777513302 | GALAXY
 1     | 0.9904188657285139 | STAR
 2     | 0.9975875623929414 | STAR
(3 rows)

SELECT index as obj_id,class FROM ml_predict('astra3.cbm', 'astra', '{}', 'spec_obj_id') LIMIT 3;
         obj_id         | class  
------------------------+--------
 4.855016555329904e+18  | GALAXY
 2.4489280322708705e+18 | STAR
 8.255357438959835e+18  | STAR
(3 rows)

SELECT *  FROM ml_predict_query('astra3.cbm', 'select * FROM astra LIMIT 3');
 index |      predict       | class  
-------+--------------------+--------
 0     | 0.9868595777513302 | GALAXY
 1     | 0.9904188657285139 | STAR
 2     | 0.9975875623929414 | STAR
(3 rows)

SELECT a.*,class FROM ml_predict('astra3.cbm', 'astra', '{}', 'spec_obj_id') as  p  , astra a WHERE p.index::text=a.spec_obj_id::text LIMIT 3 ;
      alpha       |      delta       |    u     |    g     |    r     |    i     |    z     | run_id | cam_col | field_id |      spec_obj_id       |   redshift   | plate |  mjd  | fiber_id | class  
------------------+------------------+----------+----------+----------+----------+----------+--------+---------+----------+------------------------+--------------+-------+-------+----------+--------
 16.9568897845004 | 3.64613008870454 | 23.33542 | 21.95143 | 20.48149 |   19.603 | 19.13094 |   7712 |       6 |      442 |  4.855016555329904e+18 |    0.5062369 |  4312 | 55511 |      495 | GALAXY
 240.063240247767 | 6.13413059813973 | 17.86033 | 16.79228 | 16.43001 | 16.30923 | 16.25873 |   3894 |       1 |      243 | 2.4489280322708705e+18 | 0.0003448142 |  2175 | 54612 |      348 | STAR
  30.887222067625 | 1.18870964120799 | 18.18911 | 16.89469 | 16.42161 | 16.24627 | 16.18549 |   7717 |       1 |      536 |  8.255357438959835e+18 | 4.085216e-06 |  7332 | 56683 |      943 | STAR
(3 rows)

